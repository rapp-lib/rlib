<?=$c["header"]?>

<div class="right">

<h2 class="admin_h2" id="user"><?=$c["label"]?><span></span></h2>

{{form action="."|page_to_url form=$forms.search}}
	<div class="ad_btn clearfix">
		<table class="tbl_admin search">
            <tr>
                <th>フリーワード検索</th>
                <td>{{input name="freeword" type="text" size="40" class="input-text"}}</td>
            </tr>
		</table>
		<a href="javascript:void(0);" onclick="$(this).parents('form').trigger('submit');" class="search"><i class="fa fa-search"></i>検索</a>
	</div>
{{/form}}

<div class="ad_btn clearfix">
<? if ($c["usage"] != "view"): ?>
    <a href='{{".entry_form"|page_to_url}}' class="create">新規登録</a>
<? endif; /* $c["usage"] != "view" */ ?>
<? if ($c["usage"] != "form" && $c["use_csv"]): ?>
    <a href='{{".view_csv"|page_to_url}}' class="export">CSV一括ダウンロード</a>
<? endif; /* $c["usage"] != "form" && $c["use_csv"] */ ?>
<? if ($c["usage"] != "view" && $c["use_csv"]): ?>
    <a href='{{".entry_csv_form"|page_to_url}}' class="import">CSVインポート</a>
<? endif; /* $c["usage"] != "view" && $c["use_csv"] */ ?>
</div>

<table class="tbl_admin list">
	<tr>
<? foreach ($this->filter_fields($t["fields"],"list") as $tc): ?>
		<th><?=$tc['label']?></th>
<? endforeach; ?>
		<th>&nbsp;</th>
	</tr>
	{{foreach $ts as $t}}
	<tr>
<? foreach ($this->filter_fields($t["fields"],"list") as $tc): ?>
		<td>
			{{$t.<?=$tc['name']?><?=$tc['modifier']?>}}
		</td>
<? endforeach; ?>
		<td>
<? if ($c["usage"] != "view"): ?>
            <a href='{{".entry_form"|page_to_url|url:["id"=>$t.id]}}' class="edit">編集</a>
            <a href='{{".delete"|page_to_url|url:["id"=>$t.id]}}' class="delete" onclick="return confirm('削除します');">削除</a>
<? endif; /* $c["usage"] != "view" */ ?>
		</td>
	</tr>
	{{/foreach}}
</table>

{{if $p = $ts->getPager()}}
    <div class="pager">
    <p>全{{$p->get("count")}}件中 {{$p->get("current_volume")}}件を表示</p>
    <ul class="clearfix">
    {{if $p->getPage('prev')}}
        <li class="prev"><a href="{{$forms.search->getSearchPageUrl(['p'=>$p->getPage('prev')])}}">&lt;</a></li>
    {{/if}}
    {{foreach $p->getPages(5) as $page}}
        {{if $page == "last"}}<li>...</li>{{/if}}
        {{if $page == $p->getPage("current")}}<li class="current">{{else}}<li>{{/if}}
        <a href="{{$forms.search->getSearchPageUrl(['p'=>$p->getPage($page)])}}">{{$p->getPage($page)}}</a>
        </li>
        {{if $page == "first"}}<li>...</li>{{/if}}
    {{/foreach}}
    {{if $p->getPage("next")}}
        <li class="next"><a href="{{$forms.search->getSearchPageUrl(['p'=>$p->getPage('next')])}}">&gt;</a></li>
    {{/if}}
    </ul>
    </div>
{{/if}}

</div><!--right-->

<?=$c["footer"]?>