{{form action="."|page_to_url form=$forms.search}}
    <div class="ad_btn clearfix">
        <table class="tbl_admin">
            <tr>
                <th>フリーワード検索</th>
                <td>{{input name="freeword" type="text" size="40" class="input-text"}}</td>
            </tr>
        </table>
        <a href="{{$forms.search->getSearchPageUrl()}}" class="search">リセット</a>
        <button type="submit" class="search">検索</button>
    </div>
{{/form}}

<a id="table-sort" data-sort-base-url='{{$forms.search->getSearchPageUrl(["p"=>0, "sort"=>""])}}' data-sort-current="{{$forms.search.sort}}" data-sort-param-name="sort" data-sort-default="<?=$table->getOrdCol() ? $table->getOrdCol()->getName() : $table->getIdCol()->getName()?>"></a>
{{asset required=["rui.sort"]}}

<div class="ad_btn clearfix">
<?php if ($pageset = $controller->getPagesetByType("form")): ?>
    <a href='{{"<?=$pageset->getIndexPage()->getLocalPage()?>"|page_to_url}}' class="create">新規登録</a>
<?php endif; ?>
<?php if ($pageset = $controller->getPagesetByType("csv")): ?>
    <a href='{{"<?=$pageset->getIndexPage()->getLocalPage()?>"|page_to_url}}' class="export">CSVダウンロード</a>
<?php endif; ?>
<?php if ($pageset = $controller->getPagesetByType("import")): ?>
    <a href='{{"<?=$pageset->getIndexPage()->getLocalPage()?>"|page_to_url}}' class="import">一括登録</a>
<?php endif; ?>
</div>

{{if count($ts)==0}}

<p>該当する情報がありません</p>

{{else}}{{* 0件ではない場合 *}}

<table class="tbl_admin list">
    <tr>
<?php foreach ($controller->getListCols() as $col): ?>
        <th><?=$col->getLabel()?></th>
<?php endforeach; ?>
        <th>&nbsp;</th>
    </tr>
    {{foreach $ts as $t}}
    <tr>
<?php foreach ($controller->getListCols() as $col): ?>
        <td><?=$col->getShowSource()?></td>
<?php endforeach; ?>
        <td>
<?php if ($pageset = $controller->getPagesetByType("form")): ?>
            <a href='{{"<?=$pageset->getIndexPage()->getLocalPage()?>"|page_to_url:["id"=>$t.id]}}' class="edit">編集</a>
<?php else: ?>
            <a href='{{"<?=$page->getParent()->getPageByType("detail")->getLocalPage()?>"|page_to_url:["id"=>$t.id]}}'>詳細</a>
<?php endif; ?>
<?php if ($pageset = $controller->getPagesetByType("delete")): ?>
            <a href='{{"<?=$pageset->getIndexPage()->getLocalPage()?>"|page_to_url:["id"=>$t.id]}}' class="delete" onclick="return confirm('削除します');">削除</a>
<?php endif; ?>
        </td>
    </tr>
    {{/foreach}}
</table>

{{if $p = $ts->getPager()}}
    <div class="pager">
    <p>全{{$p->get("count")}}件中 {{$p->get("current_volume")}}件を表示</p>
    <ul class="clearfix">
    {{if $p->getPage('prev')}}
        <li class="prev"><a href="{{$forms.search->getSearchPageUrl(['p'=>$p->getPage('prev')])}}">&lt;</a></li>
    {{/if}}
    {{foreach $p->getPages(5) as $page}}
        {{if $page == "last"}}<li>...</li>{{/if}}
        {{if $page == $p->getPage("current")}}<li class="current">{{else}}<li>{{/if}}
        <a href="{{$forms.search->getSearchPageUrl(['p'=>$p->getPage($page)])}}">{{$p->getPage($page)}}</a>
        </li>
        {{if $page == "first"}}<li>...</li>{{/if}}
    {{/foreach}}
    {{if $p->getPage("next")}}
        <li class="next"><a href="{{$forms.search->getSearchPageUrl(['p'=>$p->getPage('next')])}}">&gt;</a></li>
    {{/if}}
    </ul>
    </div>
{{/if}}

{{/if}}{{* /0件ではない場合 *}}